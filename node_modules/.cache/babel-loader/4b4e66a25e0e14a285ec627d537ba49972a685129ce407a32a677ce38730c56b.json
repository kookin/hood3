{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Type = void 0;\n/**\n * An SSZ type provides the following operations:\n * - Serialization from/to bytes to either a value or a tree\n * - Merkelization to compute the hashTreeRoot of both a value and a tree\n * - Proof creation from trees\n * - Create a View and a ViewDU instance from a tree\n * - Manipulate views\n */\nclass Type {\n  /** INTERNAL METHOD: Merkleize value to tree */\n  value_toTree(value) {\n    // TODO: Un-performant path but useful for prototyping. Overwrite in Type if performance is important\n    const uint8Array = new Uint8Array(this.value_serializedSize(value));\n    const dataView = new DataView(uint8Array.buffer, uint8Array.byteOffset, uint8Array.byteLength);\n    this.value_serializeToBytes({\n      uint8Array,\n      dataView\n    }, 0, value);\n    return this.tree_deserializeFromBytes({\n      uint8Array,\n      dataView\n    }, 0, uint8Array.length);\n  }\n  /** INTERNAL METHOD: Un-merkleize tree to value */\n  tree_toValue(node) {\n    // TODO: Un-performant path but useful for prototyping. Overwrite in Type if performance is important\n    const uint8Array = new Uint8Array(this.tree_serializedSize(node));\n    const dataView = new DataView(uint8Array.buffer, uint8Array.byteOffset, uint8Array.byteLength);\n    this.tree_serializeToBytes({\n      uint8Array,\n      dataView\n    }, 0, node);\n    return this.value_deserializeFromBytes({\n      uint8Array,\n      dataView\n    }, 0, uint8Array.length);\n  }\n  /** Serialize a value to binary data */\n  serialize(value) {\n    const uint8Array = new Uint8Array(this.value_serializedSize(value));\n    const dataView = new DataView(uint8Array.buffer, uint8Array.byteOffset, uint8Array.byteLength);\n    this.value_serializeToBytes({\n      uint8Array,\n      dataView\n    }, 0, value);\n    return uint8Array;\n  }\n  /** Deserialize binary data to value */\n  deserialize(uint8Array) {\n    // Buffer.prototype.slice does not copy memory, force use Uint8Array.prototype.slice https://github.com/nodejs/node/issues/28087\n    // - Uint8Array.prototype.slice: Copy memory, safe to mutate\n    // - Buffer.prototype.slice: Does NOT copy memory, mutation affects both views\n    // We could ensure that all Buffer instances are converted to Uint8Array before calling value_deserializeFromBytes\n    // However doing that in a browser friendly way is not easy. Downstream code uses `Uint8Array.prototype.slice.call`\n    // to ensure Buffer.prototype.slice is never used. Unit tests also test non-mutability.\n    const dataView = new DataView(uint8Array.buffer, uint8Array.byteOffset, uint8Array.byteLength);\n    return this.value_deserializeFromBytes({\n      uint8Array,\n      dataView\n    }, 0, uint8Array.length);\n  }\n}\nexports.Type = Type;","map":{"version":3,"names":["Type","value_toTree","value","uint8Array","Uint8Array","value_serializedSize","dataView","DataView","buffer","byteOffset","byteLength","value_serializeToBytes","tree_deserializeFromBytes","length","tree_toValue","node","tree_serializedSize","tree_serializeToBytes","value_deserializeFromBytes","serialize","deserialize","exports"],"sources":["../../src/type/abstract.ts"],"sourcesContent":[null],"mappings":";;;;;;AAwCA;;;;;;;;AAQA,MAAsBA,IAAI;EA6CxB;EACAC,YAAYA,CAACC,KAAQ;IACnB;IACA,MAAMC,UAAU,GAAG,IAAIC,UAAU,CAAC,IAAI,CAACC,oBAAoB,CAACH,KAAK,CAAC,CAAC;IACnE,MAAMI,QAAQ,GAAG,IAAIC,QAAQ,CAACJ,UAAU,CAACK,MAAM,EAAEL,UAAU,CAACM,UAAU,EAAEN,UAAU,CAACO,UAAU,CAAC;IAC9F,IAAI,CAACC,sBAAsB,CAAC;MAACR,UAAU;MAAEG;IAAQ,CAAC,EAAE,CAAC,EAAEJ,KAAK,CAAC;IAC7D,OAAO,IAAI,CAACU,yBAAyB,CAAC;MAACT,UAAU;MAAEG;IAAQ,CAAC,EAAE,CAAC,EAAEH,UAAU,CAACU,MAAM,CAAC;EACrF;EAEA;EACAC,YAAYA,CAACC,IAAU;IACrB;IACA,MAAMZ,UAAU,GAAG,IAAIC,UAAU,CAAC,IAAI,CAACY,mBAAmB,CAACD,IAAI,CAAC,CAAC;IACjE,MAAMT,QAAQ,GAAG,IAAIC,QAAQ,CAACJ,UAAU,CAACK,MAAM,EAAEL,UAAU,CAACM,UAAU,EAAEN,UAAU,CAACO,UAAU,CAAC;IAC9F,IAAI,CAACO,qBAAqB,CAAC;MAACd,UAAU;MAAEG;IAAQ,CAAC,EAAE,CAAC,EAAES,IAAI,CAAC;IAC3D,OAAO,IAAI,CAACG,0BAA0B,CAAC;MAACf,UAAU;MAAEG;IAAQ,CAAC,EAAE,CAAC,EAAEH,UAAU,CAACU,MAAM,CAAC;EACtF;EAOA;EACAM,SAASA,CAACjB,KAAQ;IAChB,MAAMC,UAAU,GAAG,IAAIC,UAAU,CAAC,IAAI,CAACC,oBAAoB,CAACH,KAAK,CAAC,CAAC;IACnE,MAAMI,QAAQ,GAAG,IAAIC,QAAQ,CAACJ,UAAU,CAACK,MAAM,EAAEL,UAAU,CAACM,UAAU,EAAEN,UAAU,CAACO,UAAU,CAAC;IAC9F,IAAI,CAACC,sBAAsB,CAAC;MAACR,UAAU;MAAEG;IAAQ,CAAC,EAAE,CAAC,EAAEJ,KAAK,CAAC;IAC7D,OAAOC,UAAU;EACnB;EAEA;EACAiB,WAAWA,CAACjB,UAAsB;IAChC;IACA;IACA;IACA;IACA;IACA;IAEA,MAAMG,QAAQ,GAAG,IAAIC,QAAQ,CAACJ,UAAU,CAACK,MAAM,EAAEL,UAAU,CAACM,UAAU,EAAEN,UAAU,CAACO,UAAU,CAAC;IAC9F,OAAO,IAAI,CAACQ,0BAA0B,CAAC;MAACf,UAAU;MAAEG;IAAQ,CAAC,EAAE,CAAC,EAAEH,UAAU,CAACU,MAAM,CAAC;EACtF;;AAvFFQ,OAAA,CAAArB,IAAA,GAAAA,IAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}